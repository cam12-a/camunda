# camunda
Реализация Статусной модели процесса
Сервисы:
1.	Camunda
2.	Сервис помощников
3.	Сервис нотификаций
4.	Kafka

Camunda
Необходимо поднять сервис и реализовать в нем следующее:
1.	Статусная модель
Необходимо реализовать способ быстрой конфигурации перевода состояния процесса из одного в другой. При этом, необходимо соблюсти следующие требования:
a.	Изменение значение статуса в camunda
b.	Должен быть способ задать статусную модель непосредственно в bpmn, а не на программном уровне.
c.	Должна быть возможность настраивать текст и заголовок уведомления при изменении статуса, как оператору, так и его помощнику.
d.	Реализовать API для изменения статуса. Предусмотреть, чтобы при изменении статуса, так же двигался процесс. Например, если заявка на согласовании руководителем, а через api послать запрос на изменение статуса в значение «Согласована», то руководитель должен потерять возможность согласовать заявку, а процесс перейдет к кадровику.
e.	После согласования заявки руководителем или помощником, необходимо перевести процесс в статус «Согласовано»
f.	При отклонении заявки руководителем или помощником, необходимо перевести процесс в статус «Отклонено»
g.	При отклонении заявки кадровиком или его помощником, необходимо перевести процесс в статус «Исполнена»
h.	При изменении статуса необходимо:
i.	Валидировать новое значение статуса, что оно уже задано или что статус не соответствует статусной модели процесса.
ii.	Отправлять c помощью кафки сообщение участникам процесса о смене статуса. Как непосредственно оператору, так и его помощнику.
iii.	Предусмотреть вариант отката статуса на прежнее значение, при возникновении ошибки.
2.	Реализовать процесс «Заявка на временное отсутствие в рабочее время»
Необходимо реализовать процесс для автоматизации заявки на временное отсутствие сотрудником (роль - employee). Заявка обрабатывается его руководителем (роль - manager) или его помощником (роль – manager_assistant). Если процесс согласован, то заявка идет в отдел hr, где ее обрабатывает кадровик (роль - hr) или его помощник (роль – hr_assistant). 
a.	Сотрудник должен:
i.	При старте процесса заполнить поля:
1.	 Отсутствие с
2.	Отсутствие по
3.	Причина отсутствия
ii.	При согласовании заявки получить уведомление:
1.	Тема: «Кабинет руководителя»
2.	Текст уведомления: «Ваша заявка была согласована вашим руководителем», если заявку согласовал manager. Если заявку согласовал manager_assistant, то сообщение должно быть: «Ваша заявка была согласована помощником руководителя».
iii.	При отклонении заявки получить уведомление:
1.	Тема: «Кабинет руководителя»
2.	Текст уведомления: «Ваша заявка была отклонена вашим руководителем», если заявку согласовал manager. Если заявку согласовал manager_assistant, то сообщение должно быть: «Ваша заявка была отклонена помощником руководителя».
iv.	После обработки заявки hr оператором, должно придти уведомление:
1.	Тема: «Отдел кадров»
2.	Текст уведомления: «Ваша заявка была обработана в hr отделе», если заявку согласовал manager. Если заявку согласовал manager_assistant, то сообщение должно быть: «Ваша заявка была обработана помощником в hr отделе».
b.	Руководитель должен:
i.	При появлении заявки от сотрудника обработать заявку. Ее можно согласовать или отклонить.
ii.	При появлении заявки руководителю должно прити уведомление:
1.	Тема: «Заявка на отсутствие в рабочее время»
2.	Текст уведомления: «Вам поступила заявка от сотрудника»
c.	Помощник руководителя:
i.	Если в сервисе помощников стоит, что у руководителя есть помощник, то он может так же обработать заявку. Он ее может согласовать или отклонить.
ii.	При появлении заявки помощнику должно приди уведомление:
1.	Тема: «Заявка на отсутствие в рабочее время»
2.	Текст уведомления: «Вам поступила заявка от сотрудника. Сообщение получено в качестве помощника»
d.	Кадровик должен:
i.	При согласовании заявки руководителем или его помощником, обработать заявку. После обработки процесс «Заявка на временное отсутствие в рабочее время» завершается.
ii.	При появлении заявки кадровику должно приди уведомление:
1.	Тема: «Заявка на отсутствие в рабочее время»
2.	Текст уведомления: «Заявка была согласована руководителем, пожалуйста, обработайте ее»
iii.	
e.	Помощник кадровика должен:
i.	Если в сервисе помощников стоит, что у кадровика есть помощник, то он может так же обработать заявку. Он ее может обработать.
ii.	При появлении заявки помощнику кадровика должно приди уведомление:
1.	Тема: «Заявка на отсутствие в рабочее время»
2.	Текст уведомления: «Заявка была согласована руководителем, пожалуйста, обработайте ее. Уведомление получено в качестве помощника»
f.	Предусмотреть, чтобы при согласовании оператором, у помощника не было возможности ее согласовать/обработать
g.	Предусмотреть, что если у оператора нет помощника, то возможности на согласовать/обработать не было у помощника.
h.	Если у оператора нет помощника, то уведомления идут только оператору.
i.	Если у оператора есть помощник, то уведомления идут обоим.


Сервис помощников
Необходимо реализовать отдельный сервис на Spring Boot, который будет хранить в себе связки Оператора – Помощник. 
Сервис помощника доложен:
1.	При его запуске список связок Оператор – Помощник должен быть пустой.
2.	Иметь API для добавления связки Оператор – Помощник. 
3.	Иметь APi для получения id помощника по id оператора.
 
Сервис нотификаций:
Необходимо реализовать отдельный сервис на Spring Boot, который будет обрабатывать запросы на отправку уведомлений. 
	Сервис нотификаций должен:
1.	Слушать кафку для получения новых уведомлений.
2.	При получении сообщения из кафки, записать в логи тему и текст уведомления, а также id получателя уведомления.

Общее:
1.	Все сервисы необходимо поднять в docker-compose.
2.	Полученный результат залить в GitLab или GitHub.
3.	Время выполнения задания 2 недели.
